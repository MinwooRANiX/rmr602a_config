<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Wi-Fi 설정 페이지</title>
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;margin:0;background:#f6f7fb;color:#111}
    .container{max-width:480px;margin:44px auto;padding:22px;background:white;border-radius:12px;box-shadow:0 6px 20px rgba(0,0,0,0.08)}
    h1{font-size:18px;margin:0 0 12px}
    .row{display:flex;align-items:center;gap:10px;margin-top:12px}
    .cb{width:18px;height:18px}
    label.field{min-width:110px}
    input[type="text"],input[type="password"]{flex:1;padding:10px;border:1px solid #ddd;border-radius:8px}
    .actions{display:flex;gap:8px;margin-top:16px}
    button{padding:10px 14px;border:0;border-radius:10px;background:#2563eb;color:#fff;font-weight:700;cursor:pointer}
    button.alt{background:#10b981}
    .result{margin-top:12px;padding:10px;background:#f3f4f6;border-radius:8px;font-family:monospace;word-break:break-all;display:none}
    .hint{font-size:12px;color:#666;margin-top:8px}
  </style>
</head>
<body>
  <div class="container" role="main">
    <h1>Wi-Fi 설정</h1>

    <div class="row">
      <input id="cb_ssid" class="cb" type="checkbox" checked />
      <label class="field" for="ssid">Wi-Fi SSID</label>
      <input id="ssid" type="text" placeholder="예: SK_WiFiGIGA564B" />
    </div>

    <div class="row">
      <input id="cb_pw" class="cb" type="checkbox" checked />
      <label class="field" for="pw">Wi-Fi Password</label>
      <input id="pw" type="password" placeholder="예: 1801000483" />
    </div>

    <div class="actions">
      <button id="sendBtn">요청 전송</button>
      <button id="buildBtn" class="alt">요청 URL 미리보기</button>
      <button id="copyBtn" style="background:#6b7280">복사</button>
    </div>

    <div class="hint">체크된 항목만 URL에 포함됩니다.</div>
    <div id="result" class="result"></div>
  </div>

  <script>
    const cbSsid = document.getElementById('cb_ssid');
    const cbPw   = document.getElementById('cb_pw');
    const ssidInput = document.getElementById('ssid');
    const pwInput   = document.getElementById('pw');
    const sendBtn  = document.getElementById('sendBtn');
    const buildBtn = document.getElementById('buildBtn');
    const copyBtn  = document.getElementById('copyBtn');
    const result   = document.getElementById('result');

    function e(v){ return encodeURIComponent(v ?? ''); }

    // ✅ 체크된 항목만 포함 (해제된 항목은 완전히 생략)
    function buildDeviceUrl() {
      const base = 'http://192.168.4.1/command';
      const params = [];
      if (cbSsid.checked) params.push('ssid=' + e(ssidInput.value.trim()));
      if (cbPw.checked)   params.push('pw='   + e(pwInput.value));
      return params.length ? `${base}?${params.join('&')}` : base;
    }

    buildBtn.addEventListener('click', () => {
      const u = buildDeviceUrl();
      result.style.display = 'block';
      result.textContent = u;
    });

    copyBtn.addEventListener('click', () => {
      const u = buildDeviceUrl();
      navigator.clipboard.writeText(u).then(()=>{
        copyBtn.textContent='복사됨';
        setTimeout(()=>copyBtn.textContent='복사',1200);
      }).catch(()=> alert('복사 실패 — 권한 확인'));
    });

    sendBtn.addEventListener('click', () => {
      const url = buildDeviceUrl();
      window.location.href = url;
    });

    // QR로 기본값 전달 가능 (?ssid=...&pw=...)
    (function fillFromQuery(){
      const p = new URLSearchParams(location.search);
      if(p.has('ssid')) ssidInput.value = p.get('ssid');
      if(p.has('pw'))   pwInput.value   = p.get('pw');
    })();
  </script>
</body>
</html>
